---
slug: /library/advanced-features/st.cache
title: Optimize performance with st.cache
---

<å¼ƒç”¨>

`st.cache`åœ¨1.18.0ç‰ˆæœ¬ä¸­å·²è¢«å¼ƒç”¨ã€‚è¯·æ”¹ç”¨[`st.cache_data`](/library/api-reference/performance/st.cache_data)æˆ–[`st.cache_resource`](/library/api-reference/performance/st.cache_resource)ã€‚äº†è§£æ›´å¤šä¿¡æ¯è¯·å‚é˜…[ç¼“å­˜](/library/advanced-features/caching)ã€‚

</å¼ƒç”¨>

# ä½¿ç”¨st.cacheä¼˜åŒ–æ€§èƒ½

Streamlitæä¾›äº†ä¸€ä¸ªç¼“å­˜æœºåˆ¶ï¼Œä½¿å¾—æ‚¨çš„åº”ç”¨åœ¨ä»ç½‘ç»œåŠ è½½æ•°æ®ã€æ“ä½œå¤§å‹æ•°æ®é›†æˆ–æ‰§è¡Œæ˜‚è´µçš„è®¡ç®—æ—¶ä¿æŒé«˜æ€§èƒ½ã€‚è¿™æ˜¯é€šè¿‡[`@st.cache`](/library/api-reference/performance/st.cache)è£…é¥°å™¨å®ç°çš„ã€‚

å½“æ‚¨ä½¿ç”¨[`@st.cache`](/library/api-reference/performance/st.cache)è£…é¥°å™¨æ ‡è®°ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒå‘Šè¯‰Streamlitåœ¨æ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ—¶éœ€è¦æ£€æŸ¥ä¸€äº›äº‹æƒ…ï¼š

1. æ‚¨è°ƒç”¨å‡½æ•°æ—¶ä½¿ç”¨çš„è¾“å…¥å‚æ•°
2. å‡½æ•°ä¸­ä½¿ç”¨çš„ä»»ä½•å¤–éƒ¨å˜é‡çš„å€¼
3. å‡½æ•°çš„ä¸»ä½“
4. ç¼“å­˜å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„ä»»ä½•å‡½æ•°çš„ä¸»ä½“

å¦‚æœè¿™æ˜¯Streamlitç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™å››ä¸ªå…·æœ‰è¿™äº›ç¡®åˆ‡å€¼ã€ç¡®åˆ‡ç»„åˆå’Œé¡ºåºçš„ç»„ä»¶ï¼Œå®ƒå°†è¿è¡Œå‡½æ•°å¹¶å°†ç»“æœå­˜å‚¨åœ¨æœ¬åœ°ç¼“å­˜ä¸­ã€‚ç„¶åï¼Œä¸‹æ¬¡è°ƒç”¨ç¼“å­˜å‡½æ•°æ—¶ï¼Œå¦‚æœè¿™äº›ç»„ä»¶éƒ½æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼ŒStreamlitå°†ç›´æ¥è·³è¿‡æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯è¿”å›å…ˆå‰å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„è¾“å‡ºã€‚

Streamlitè·Ÿè¸ªè¿™äº›ç»„ä»¶çš„å˜åŒ–æ–¹å¼æ˜¯é€šè¿‡å“ˆå¸Œã€‚å°†ç¼“å­˜è§†ä¸ºä¸€ä¸ªå†…å­˜ä¸­çš„é”®å€¼å­˜å‚¨ï¼Œå…¶ä¸­é”®æ˜¯æ‰€æœ‰ä¸Šè¿°å†…å®¹çš„å“ˆå¸Œå€¼ï¼Œå€¼æ˜¯å®é™…çš„è¾“å‡ºå¯¹è±¡é€šè¿‡å¼•ç”¨ä¼ é€’ã€‚

æœ€åï¼Œ[`@st.cache`](/library/api-reference/performance/st.cache)æ”¯æŒé…ç½®ç¼“å­˜è¡Œä¸ºçš„å‚æ•°ã€‚æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„[APIå‚è€ƒ](/library/api-reference)ä¸­æ‰¾åˆ°æ›´å¤šä¿¡æ¯ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€äº›ç¤ºä¾‹ï¼Œä»¥è¯´æ˜åœ¨Streamlitåº”ç”¨ç¨‹åºä¸­ç¼“å­˜æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

## ç¤ºä¾‹1ï¼šåŸºæœ¬ç”¨æ³•

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ‰§è¡Œæ˜‚è´µä¸”è€—æ—¶çš„è®¡ç®—çš„å‡½æ•°ã€‚å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œæ¯æ¬¡åˆ·æ–°åº”ç”¨ç¨‹åºæ—¶éƒ½ä¼šé‡æ–°è¿è¡Œè¯¥å‡½æ•°ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒè¾ƒå·®ã€‚å°†ä»¥ä¸‹ä»£ç å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè‡ªå·±è¯•ä¸€è¯•ï¼š

```python
import streamlit as st
import time

def expensive_computation(a, b):
    time.sleep(2)  # ğŸ‘ˆ This makes the function take 2s to run
    return a * b

a = 2
b = 21
res = expensive_computation(a, b)

st.write("Result:", res)
```

å°è¯•æŒ‰ä¸‹ **R** é”®é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå¹¶æ³¨æ„ç»“æœæ˜¾ç¤ºæ‰€éœ€çš„æ—¶é—´ã€‚è¿™æ˜¯å› ä¸ºæ¯æ¬¡åº”ç”¨ç¨‹åºè¿è¡Œæ—¶éƒ½ä¼šé‡æ–°æ‰§è¡Œ `expensive_computation(a, b)`ã€‚è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä½“éªŒã€‚

è®©æˆ‘ä»¬æ·»åŠ  [`@st.cache`](/library/api-reference/performance/st.cache) è£…é¥°å™¨ï¼š

```python
import streamlit as st
import time

@st.cache  # ğŸ‘ˆ Added this
def expensive_computation(a, b):
    time.sleep(2)  # This makes the function take 2s to run
    return a * b

a = 2
b = 21
res = expensive_computation(a, b)

st.write("Result:", res)
```

ç°åœ¨å†æ¬¡è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ‚¨ä¼šæ³¨æ„åˆ°æ¯æ¬¡æŒ‰ä¸‹Ré‡æ–°è¿è¡Œæ—¶é€Ÿåº¦éƒ½ä¼šæ›´å¿«ã€‚ä¸ºäº†äº†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬åœ¨å‡½æ•°å†…éƒ¨æ·»åŠ ä¸€ä¸ªst.writeï¼š

```python
import streamlit as st
import time

@st.cache(suppress_st_warning=True)  # ğŸ‘ˆ Changed this
def expensive_computation(a, b):
    # ğŸ‘‡ Added this
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return a * b

a = 2
b = 21
res = expensive_computation(a, b)

st.write("Result:", res)
```

ç°åœ¨å½“æ‚¨é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ä¼šå‡ºç°â€œCache missâ€æ–‡æœ¬ï¼Œä½†åœ¨éšåçš„è¿è¡Œä¸­ä¸ä¼šå‡ºç°ã€‚è¿™æ˜¯å› ä¸ºç¼“å­˜å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åæ¯æ¬¡éƒ½ä¼šå‘½ä¸­ç¼“å­˜ã€‚

<æ³¨æ„>

æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬åœ¨`@st.cache`è£…é¥°å™¨ä¸­æ·»åŠ äº†`suppress_st_warning`å…³é”®å­—ã€‚è¿™æ˜¯å› ä¸ºä¸Šé¢çš„ç¼“å­˜å‡½æ•°æœ¬èº«ä½¿ç”¨äº†Streamlitçš„å‘½ä»¤ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯`st.write`ï¼‰ï¼Œå½“Streamlitçœ‹åˆ°è¿™ä¸ªå‘½ä»¤æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªè­¦å‘Šï¼Œå‘Šè¯‰æ‚¨çš„å‘½ä»¤åªä¼šåœ¨ç¼“å­˜æœªå‘½ä¸­æ—¶æ‰§è¡Œã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“æ‚¨çœ‹åˆ°è¿™ä¸ªè­¦å‘Šæ—¶ï¼Œæ„å‘³ç€ä»£ç ä¸­å¯èƒ½å­˜åœ¨é”™è¯¯ã€‚ç„¶è€Œï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨`st.write`å‘½ä»¤æ¥æ¼”ç¤ºç¼“å­˜æœªå‘½ä¸­çš„æƒ…å†µï¼Œæ‰€ä»¥Streamlitè­¦å‘Šçš„è¡Œä¸ºæ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼ å…¥`suppress_st_warning=True`æ¥å…³é—­è¿™ä¸ªè­¦å‘Šã€‚

</Note>

## ç¤ºä¾‹2: å½“å‡½æ•°å‚æ•°å‘ç”Ÿå˜åŒ–æ—¶

åœ¨ä¸åœæ­¢ä¹‹å‰çš„åº”ç”¨æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹ç¼“å­˜å‡½æ•°çš„ä¸€ä¸ªå‚æ•°:

```python
import streamlit as st
import time

@st.cache(suppress_st_warning=True)
def expensive_computation(a, b):
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return a * b

a = 2
b = 210  # ğŸ‘ˆ Changed this
res = expensive_computation(a, b)

st.write("Result:", res)
```

ç°åœ¨ï¼Œå½“æ‚¨ç¬¬ä¸€æ¬¡é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œä¼šå‡ºç°ç¼“å­˜æœªå‘½ä¸­çš„æƒ…å†µã€‚è¿™å¯ä»¥é€šè¿‡æ˜¾ç¤ºâ€œç¼“å­˜æœªå‘½ä¸­â€æ–‡æœ¬å¹¶ä¸”åº”ç”¨ç¨‹åºéœ€è¦2ç§’æ‰èƒ½å®Œæˆè¿è¡Œæ¥è¯æ˜ã€‚ä¹‹åï¼Œå¦‚æœæ‚¨æŒ‰ä¸‹**R**é”®é‡æ–°è¿è¡Œï¼Œå®ƒå°†å§‹ç»ˆæ˜¯ç¼“å­˜å‘½ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä¼šæ˜¾ç¤ºæ­¤ç±»æ–‡æœ¬ï¼Œåº”ç”¨ç¨‹åºå†æ¬¡å˜å¾—å¿«é€Ÿã€‚

è¿™æ˜¯å› ä¸ºStreamlitä¼šæ³¨æ„åˆ°å‚æ•°**a**å’Œ**b**ä½•æ—¶å‘ç”Ÿå˜åŒ–ï¼Œå¹¶ç¡®å®šæ˜¯å¦åº”é‡æ–°æ‰§è¡Œå’Œé‡æ–°ç¼“å­˜è¯¥å‡½æ•°ã€‚

## ç¤ºä¾‹3: å½“å‡½æ•°ä¸»ä½“å‘ç”Ÿå˜åŒ–æ—¶

åœ¨ä¸åœæ­¢å’Œé‡æ–°å¯åŠ¨æ‚¨çš„StreamlitæœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œè®©æˆ‘ä»¬ä»æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­åˆ é™¤å°éƒ¨ä»¶ï¼Œå¹¶é€šè¿‡å°†`+ 1`æ·»åŠ åˆ°è¿”å›å€¼æ¥ä¿®æ”¹å‡½æ•°çš„ä»£ç ã€‚

```python
import streamlit as st
import time

@st.cache(suppress_st_warning=True)
def expensive_computation(a, b):
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return a * b + 1  # ğŸ‘ˆ Added a +1 at the end here

a = 2
b = 210
res = expensive_computation(a, b)

st.write("Result:", res)
```

ç¬¬ä¸€æ¬¡è¿è¡Œæ˜¯â€œç¼“å­˜æœªå‘½ä¸­â€ï¼Œä½†æ˜¯å½“æ‚¨æŒ‰ä¸‹ **R** é”®åï¼Œæ¯æ¬¡è¿è¡Œéƒ½æ˜¯ç¼“å­˜å‘½ä¸­ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼ŒStreamlitæ£€æµ‹åˆ°å‡½æ•°ä½“å‘ç”Ÿäº†å˜åŒ–ï¼Œé‡æ–°è¿è¡Œäº†å‡½æ•°ï¼Œå¹¶å°†ç»“æœæ”¾å…¥ç¼“å­˜ä¸­ã€‚

<æç¤º>

å¦‚æœæ‚¨å°†å‡½æ•°æ”¹å›åŸæ ·ï¼Œåˆ™ç»“æœå°†å·²ç»å­˜åœ¨äºStreamlitç¼“å­˜ä¸­ï¼Œæ¥è‡ªä¸Šä¸€æ¬¡è¿è¡Œã€‚è¯•è¯•çœ‹å§ï¼

</æç¤º>

## ç¤ºä¾‹4ï¼šå½“å†…éƒ¨å‡½æ•°å‘ç”Ÿå˜åŒ–æ—¶

è®©æˆ‘ä»¬ä½¿æˆ‘ä»¬çš„ç¼“å­˜å‡½æ•°åœ¨å†…éƒ¨ä¾èµ–äºå¦ä¸€ä¸ªå‡½æ•°ï¼š

```python
import streamlit as st
import time

def inner_func(a, b):
    st.write("inner_func(", a, ",", b, ") ran")
    return a * b

@st.cache(suppress_st_warning=True)
def expensive_computation(a, b):
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return inner_func(a, b) + 1

a = 2
b = 210
res = expensive_computation(a, b)

st.write("Result:", res)
```

æ‚¨çœ‹åˆ°çš„æ˜¯é€šå¸¸æƒ…å†µä¸‹çš„æ“ä½œï¼š

1. ç¬¬ä¸€æ¬¡è¿è¡Œä¼šå¯¼è‡´ç¼“å­˜æœªå‘½ä¸­ã€‚
2. æ¯æ¬¡åç»­çš„è¿è¡Œéƒ½ä¼šå¯¼è‡´ç¼“å­˜å‘½ä¸­ã€‚

ä½†ç°åœ¨è®©æˆ‘ä»¬å°è¯•ä¿®æ”¹`inner_func()`å‡½æ•°ï¼š

```python
import streamlit as st
import time

def inner_func(a, b):
    st.write("inner_func(", a, ",", b, ") ran")
    return a ** b  # ğŸ‘ˆ Changed the * to ** here

@st.cache(suppress_st_warning=True)
def expensive_computation(a, b):
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return inner_func(a, b) + 1

a = 2
b = 21
res = expensive_computation(a, b)

st.write("Result:", res)
```

å³ä½¿`inner_func()`æ²¡æœ‰è¢«æ³¨è§£ä¸º[`@st.cache`](/library/api-reference/performance/st.cache)ï¼Œå½“æˆ‘ä»¬ç¼–è¾‘å…¶ä»£ç ä½“æ—¶ï¼Œä¼šåœ¨å¤–éƒ¨çš„`expensive_computation()`ä¸­å¼•å‘"Cache miss"ã€‚

è¿™æ˜¯å› ä¸ºStreamlitæ€»æ˜¯éå†æ‚¨çš„ä»£ç åŠå…¶ä¾èµ–é¡¹ï¼Œä»¥éªŒè¯ç¼“å­˜å€¼æ˜¯å¦ä»ç„¶æœ‰æ•ˆã€‚è¿™æ„å‘³ç€åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨å¯ä»¥è‡ªç”±åœ°ç¼–è¾‘ä»£ç ï¼Œè€Œä¸å¿…æ‹…å¿ƒç¼“å­˜ã€‚æ— è®ºæ‚¨å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œäº†å“ªäº›æ›´æ”¹ï¼ŒStreamlitéƒ½ä¼šåšæ­£ç¡®çš„äº‹æƒ…ï¼

Streamlitè¿˜èªæ˜åœ°åªéå†å±äºæ‚¨åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ï¼Œå¹¶è·³è¿‡æ¥è‡ªå·²å®‰è£…çš„Pythonåº“çš„ä»»ä½•ä¾èµ–é¡¹ã€‚

## ç¤ºä¾‹5ï¼šä½¿ç”¨ç¼“å­˜æ¥åŠ é€Ÿæ‚¨çš„åº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·ä¹‹é—´çš„ä¼ è¾“

å›åˆ°æˆ‘ä»¬çš„åŸå§‹å‡½æ•°ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå°éƒ¨ä»¶æ¥æ§åˆ¶ `b` çš„å€¼ï¼š

```python
import streamlit as st
import time

@st.cache(suppress_st_warning=True)
def expensive_computation(a, b):
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return a * b

a = 2
b = st.slider("Pick a number", 0, 10)  # ğŸ‘ˆ Changed this
res = expensive_computation(a, b)

st.write("Result:", res)
```

æ‚¨å°†çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š

- å¦‚æœæ‚¨å°†æ»‘å—æ»‘åŠ¨åˆ°Streamlitä¹‹å‰æœªè§è¿‡çš„æ•°å­—ï¼Œå†æ¬¡è¿è¡Œæ—¶ä¼šå‡ºç°ç¼“å­˜æœªå‘½ä¸­ã€‚å½“ç„¶ï¼Œæ¯æ¬¡ä½¿ç”¨ç›¸åŒçš„æ•°å­—é‡æ–°è¿è¡Œæ—¶éƒ½ä¼šå‘½ä¸­ç¼“å­˜ã€‚
- å¦‚æœæ‚¨å°†æ»‘å—æ»‘åŠ¨å›Streamlitä¹‹å‰è§è¿‡çš„æ•°å­—ï¼Œç¼“å­˜å°†è¢«å‘½ä¸­ï¼Œåº”ç”¨ç¨‹åºå°†å¦‚é¢„æœŸèˆ¬å¿«é€Ÿè¿è¡Œã€‚

åœ¨è®¡ç®—æœºç§‘å­¦æœ¯è¯­ä¸­ï¼Œè¿™é‡Œå‘ç”Ÿçš„æ˜¯[`@st.cache`](/library/api-reference/performance/st.cache)æ­£åœ¨å¯¹`expensive_computation(a, b)`è¿›è¡Œ[memoization](https://en.wikipedia.org/wiki/Memoization)ã€‚

ä½†æ˜¯ç°åœ¨è®©æˆ‘ä»¬å†è¿›ä¸€æ­¥ï¼å°è¯•ä»¥ä¸‹æ“ä½œï¼š

1. å°†æ»‘å—ç§»åŠ¨åˆ°ä¸€ä¸ªä¹‹å‰æœªå°è¯•è¿‡çš„æ•°å­—ï¼Œä¾‹å¦‚9ã€‚
2. é€šè¿‡åœ¨å¦ä¸€ä¸ªæµè§ˆå™¨æ ‡ç­¾ä¸­æ‰“å¼€æŒ‡å‘æ‚¨çš„Streamlitåº”ç”¨çš„åœ°å€ï¼ˆé€šå¸¸ä¸ºhttp://localhost:8501ï¼‰ï¼Œæ¥å‡è£…è‡ªå·±æ˜¯å¦ä¸€ä¸ªç”¨æˆ·ã€‚
3. åœ¨æ–°æ ‡ç­¾ä¸­ï¼Œå°†æ»‘å—ç§»åŠ¨åˆ°9ã€‚

æ³¨æ„è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªç¼“å­˜å‘½ä¸­ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿åœ¨ç¬¬äºŒä¸ªé€‰é¡¹å¡ä¸­çš„ç”¨æˆ·åœ¨æ­¤ä¹‹å‰ä»æœªå°†æ»‘å—ç§»åŠ¨åˆ°9ï¼Œæ‚¨å®é™…ä¸Šä¸ä¼šçœ‹åˆ°"Cache miss"æ–‡æœ¬ã€‚

è¿™æ˜¯å› ä¸ºStreamlitç¼“å­˜æ˜¯å…¨å±€çš„ï¼Œé€‚ç”¨äºæ‰€æœ‰ç”¨æˆ·ã€‚å› æ­¤ï¼Œæ¯ä¸ªäººéƒ½å¯¹å…¶ä»–äººçš„æ€§èƒ½æœ‰æ‰€è´¡çŒ®ã€‚

## ç¤ºä¾‹6ï¼šä¿®æ”¹ç¼“å­˜å€¼

æ­£å¦‚åœ¨[æ¦‚è¿°](#optimize-performance-with-stcache)éƒ¨åˆ†ä¸­æåˆ°çš„ï¼ŒStreamlitç¼“å­˜é€šè¿‡å¼•ç”¨å­˜å‚¨é¡¹ç›®ã€‚è¿™æ ·å¯ä»¥ä½¿Streamlitç¼“å­˜æ”¯æŒPythonæ²¡æœ‰è¿›è¡Œå†…å­˜ç®¡ç†çš„ç»“æ„ï¼Œä¾‹å¦‚TensorFlowå¯¹è±¡ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸º-è¿™å°±æ˜¯ä¸ºä»€ä¹ˆStreamlitæœ‰ä¸€äº›æ£€æŸ¥æ¥å¼•å¯¼å¼€å‘äººå‘˜æœæ­£ç¡®çš„æ–¹å‘å‘å±•ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›æ£€æŸ¥ã€‚

è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªè¿”å›å¯å˜å¯¹è±¡çš„ç¼“å­˜å‡½æ•°ï¼Œç„¶åè®©æˆ‘ä»¬å¯¹è¯¥å¯¹è±¡è¿›è¡Œä¿®æ”¹:

```python
import streamlit as st
import time

@st.cache(suppress_st_warning=True)
def expensive_computation(a, b):
    st.write("Cache miss: expensive_computation(", a, ",", b, ") ran")
    time.sleep(2)  # This makes the function take 2s to run
    return {"output": a * b}  # ğŸ‘ˆ Mutable object

a = 2
b = 21
res = expensive_computation(a, b)

st.write("Result:", res)

res["output"] = "result was manually mutated"  # ğŸ‘ˆ Mutated cached value

st.write("Mutated result:", res)
```

å½“æ‚¨ç¬¬ä¸€æ¬¡è¿è¡Œæ­¤åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨åº”è¯¥åœ¨å±å¹•ä¸Šçœ‹åˆ°ä¸‰æ¡æ¶ˆæ¯ï¼š

- ç¼“å­˜æœªå‘½ä¸­ï¼ˆ...ï¼‰
- ç»“æœï¼š{output: 42}
- å˜å¼‚ç»“æœï¼š{output: "result was manually mutated"}

æ²¡æœ‰ä»€ä¹ˆæ„å¤–çš„ã€‚ä½†æ˜¯ç°åœ¨è¯·æ³¨æ„å½“æ‚¨é‡æ–°è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼ˆå³æŒ‰ä¸‹ **R**ï¼‰ï¼š

- ç»“æœï¼š{output: "result was manually mutated"}
- å˜å¼‚ç»“æœï¼š{output: "result was manually mutated"}
- ç¼“å­˜å¯¹è±¡å‘ç”Ÿå˜å¼‚ï¼ˆ...ï¼‰

é‚£ä¹ˆé—®é¢˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

è¿™é‡Œå‘ç”Ÿçš„æƒ…å†µæ˜¯Streamlité€šè¿‡å¼•ç”¨ç¼“å­˜äº†è¾“å‡º`res`ã€‚å½“æ‚¨åœ¨ç¼“å­˜å‡½æ•°ä¹‹å¤–ä¿®æ”¹äº†`res["output"]`æ—¶ï¼Œæ— æ„ä¸­ä¿®æ”¹äº†ç¼“å­˜ã€‚è¿™æ„å‘³ç€å¯¹`expensive_computation(2, 21)`çš„æ¯æ¬¡åç»­è°ƒç”¨éƒ½ä¼šè¿”å›é”™è¯¯çš„å€¼ï¼

ç”±äºè¿™ç§è¡Œä¸ºé€šå¸¸ä¸æ˜¯æ‚¨æ‰€æœŸæœ›çš„ï¼ŒStreamlitè¯•å›¾æä¾›å¸®åŠ©ï¼Œå¹¶æ˜¾ç¤ºä¸€æ¡è­¦å‘Šï¼Œä»¥åŠä¸€äº›å…³äºå¦‚ä½•ä¿®å¤ä»£ç çš„æƒ³æ³•ã€‚

åœ¨è¿™ç§ç‰¹å®šæƒ…å†µä¸‹ï¼Œä¿®å¤æ–¹æ³•å°±æ˜¯ä¸è¦åœ¨ç¼“å­˜å‡½æ•°å¤–éƒ¨ä¿®æ”¹`res["output"]`ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬æ²¡æœ‰å……åˆ†çš„ç†ç”±è¿™æ ·åšï¼å¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨`res = deepcopy(expensive_computation(2, 21))`æ¥å…‹éš†ç»“æœå€¼ã€‚è¯·æŸ¥çœ‹æ ‡é¢˜ä¸º[ä¿®å¤ç¼“å­˜é—®é¢˜](/knowledge-base/using-streamlit/caching-issues)çš„éƒ¨åˆ†ï¼Œäº†è§£æ›´å¤šå…³äºè¿™äº›æ–¹æ³•å’Œæ›´å¤šçš„ä¿¡æ¯ã€‚

## é«˜çº§ç¼“å­˜

åœ¨[caching](/library/advanced-features/caching)ä¸­ï¼Œä½ å­¦ä¹ äº†Streamlitçš„ç¼“å­˜åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡[`@st.cache`](/library/api-reference/performance/st.cache)è£…é¥°å™¨æ¥è®¿é—®ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†äº†è§£Streamlitçš„ç¼“å­˜åŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æé«˜Streamlitåº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚

ç¼“å­˜æ˜¯ä¸€ä¸ªé”®å€¼å­˜å‚¨ï¼Œå…¶ä¸­é”®æ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼ç”Ÿæˆçš„å“ˆå¸Œå€¼ï¼š

1. ä½ è°ƒç”¨å‡½æ•°æ—¶çš„è¾“å…¥å‚æ•°
1. å‡½æ•°ä¸­ä½¿ç”¨çš„ä»»ä½•å¤–éƒ¨å˜é‡çš„å€¼
2. å‡½æ•°çš„ä¸»ä½“
3. ç”¨äºç¼“å­˜å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„ä»»ä½•å‡½æ•°çš„ä¸»ä½“

è€Œè¯¥å€¼æ˜¯ä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

- ç¼“å­˜è¾“å‡º
- ç¼“å­˜è¾“å‡ºçš„å“ˆå¸Œå€¼ï¼ˆå¾ˆå¿«æ‚¨å°±ä¼šæ˜ç™½åŸå› ï¼‰

å¯¹äºé”®å’Œè¾“å‡ºå“ˆå¸Œå€¼ï¼ŒStreamlitä½¿ç”¨äº†ä¸€ç§ä¸“é—¨çš„å“ˆå¸Œå‡½æ•°ï¼Œå®ƒçŸ¥é“å¦‚ä½•éå†ä»£ç ï¼Œå“ˆå¸Œç‰¹æ®Šå¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç”¨æˆ·æ¥[è‡ªå®šä¹‰å…¶è¡Œä¸º](#the-hash_funcs-parameter)ã€‚

ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨[`@st.cache`](/library/api-reference/performance/st.cache)ä¿®é¥°çš„å‡½æ•°`expensive_computation(a, b)`ä»¥`a=2`å’Œ`b=21`æ‰§è¡Œæ—¶ï¼ŒStreamlitä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

1. è®¡ç®—ç¼“å­˜é”®
2. å¦‚æœåœ¨ç¼“å­˜ä¸­æ‰¾åˆ°è¯¥é”®ï¼Œåˆ™ï¼š
   - æå–å…ˆå‰ç¼“å­˜çš„ï¼ˆè¾“å‡ºï¼Œè¾“å‡ºå“ˆå¸Œï¼‰å…ƒç»„ã€‚
   - æ‰§è¡Œ**è¾“å‡ºçªå˜æ£€æŸ¥**ï¼Œå…¶ä¸­è®¡ç®—ä¸€ä¸ªæ–°çš„è¾“å‡ºå“ˆå¸Œå¹¶ä¸å­˜å‚¨çš„`output_hash`è¿›è¡Œæ¯”è¾ƒã€‚
     - å¦‚æœä¸¤ä¸ªå“ˆå¸Œå€¼ä¸åŒï¼Œåˆ™æ˜¾ç¤º**ç¼“å­˜å¯¹è±¡å·²æ›´æ”¹**çš„è­¦å‘Šã€‚ï¼ˆæ³¨æ„ï¼šè®¾ç½® `allow_output_mutation=True` å¯ç¦ç”¨æ­¤æ­¥éª¤ï¼‰ã€‚
1. å¦‚æœç¼“å­˜ä¸­ä¸å­˜åœ¨è¾“å…¥é”®ï¼Œåˆ™ï¼š
   - æ‰§è¡Œç¼“å­˜å‡½æ•°ï¼ˆå³ `output = expensive_computation(2, 21)`ï¼‰ã€‚
   - ä»å‡½æ•°çš„è¾“å‡ºè®¡ç®— `output_hash`ã€‚
   - å°† `key â†’ (output, output_hash)` å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚
1. è¿”å›è¾“å‡ºç»“æœã€‚

å¦‚æœé‡åˆ°é”™è¯¯ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å¦‚æœåœ¨å“ˆå¸Œå¯†é’¥æˆ–è¾“å‡ºæ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ä¼šæŠ›å‡º`UnhashableTypeError`é”™è¯¯ã€‚å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·å‚é˜…[ä¿®å¤ç¼“å­˜é—®é¢˜](/knowledge-base/using-streamlit/caching-issues)ã€‚

### hash_funcså‚æ•°

å¦‚ä¸Šæ‰€è¿°ï¼ŒStreamlitçš„ç¼“å­˜åŠŸèƒ½ä¾èµ–äºå“ˆå¸Œç®—æ³•æ¥è®¡ç®—ç¼“å­˜å¯¹è±¡çš„é”®ï¼Œå¹¶æ£€æµ‹ç¼“å­˜ç»“æœä¸­çš„æ„å¤–å˜åŒ–ã€‚

ä¸ºäº†å¢åŠ è¡¨è¾¾èƒ½åŠ›ï¼ŒStreamlitå…è®¸æ‚¨ä½¿ç”¨`hash_funcs`å‚æ•°è¦†ç›–æ­¤å“ˆå¸Œè¿‡ç¨‹ã€‚å‡è®¾æ‚¨å®šä¹‰äº†ä¸€ä¸ªåä¸º`FileReference`çš„ç±»å‹ï¼Œå®ƒæŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ–‡ä»¶:

```python
class FileReference:
    def __init__(self, filename):
        self.filename = filename


@st.cache
def func(file_reference):
    ...
```

é»˜è®¤æƒ…å†µä¸‹ï¼ŒStreamlité€šè¿‡é€’å½’éå†è‡ªå®šä¹‰ç±»ï¼ˆå¦‚`FileReference`ï¼‰çš„ç»“æ„æ¥è¿›è¡Œå“ˆå¸Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„å“ˆå¸Œæ˜¯æ–‡ä»¶åå±æ€§çš„å“ˆå¸Œã€‚åªè¦æ–‡ä»¶åä¸å˜ï¼Œå“ˆå¸Œå€¼å°±ä¼šä¿æŒä¸å˜ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å¸Œæœ›å“ˆå¸Œæ£€æŸ¥æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´è€Œä¸ä»…ä»…æ˜¯æ–‡ä»¶åå‘¢ï¼Ÿè¿™å¯ä»¥é€šè¿‡[`@st.cache`](/library/api-reference/performance/st.cache)çš„`hash_funcs`å‚æ•°å®ç°ï¼š

```python
class FileReference:
    def __init__(self, filename):
        self.filename = filename

def hash_file_reference(file_reference):
    filename = file_reference.filename
    return (filename, os.path.getmtime(filename))

@st.cache(hash_funcs={FileReference: hash_file_reference})
def func(file_reference):
    ...
```

æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥é€šè¿‡æ–‡ä»¶å†…å®¹å¯¹`FileReference`å¯¹è±¡è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼š

```python
class FileReference:
    def __init__(self, filename):
        self.filename = filename

def hash_file_reference(file_reference):
    with open(file_reference.filename) as f:
      return f.read()

@st.cache(hash_funcs={FileReference: hash_file_reference})
def func(file_reference):
    ...
```

<æ³¨æ„>

ç”±äºStreamlitçš„å“ˆå¸Œå‡½æ•°æ˜¯é€’å½’çš„ï¼Œæ‚¨æ— éœ€åœ¨`hash_file_reference`ä¸­å“ˆå¸Œæ–‡ä»¶å†…å®¹ã€‚ç›¸åï¼Œæ‚¨å¯ä»¥è¿”å›ä¸€ä¸ªåŸå§‹ç±»å‹ï¼Œä¾‹å¦‚æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åStreamlitçš„å†…éƒ¨å“ˆå¸Œè®¡ç®—å™¨å°†ä»ä¸­è®¡ç®—å®é™…å“ˆå¸Œå€¼ã€‚

</æ³¨æ„>

### å…¸å‹çš„å“ˆå¸Œå‡½æ•°

è™½ç„¶å¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„å“ˆå¸Œå‡½æ•°ï¼Œä½†è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹Pythonæä¾›çš„ä¸€äº›å¼€ç®±å³ç”¨çš„å·¥å…·ã€‚ä¸‹é¢æ˜¯ä¸€äº›å“ˆå¸Œå‡½æ•°åŠå…¶é€‚ç”¨åœºæ™¯çš„åˆ—è¡¨ã€‚

Pythonçš„[`id`](https://docs.python.org/3/library/functions.html#id)å‡½æ•° | [ç¤ºä¾‹](#example-1-pass-a-database-connection-around)

- é€Ÿåº¦ï¼šå¿«é€Ÿ
- ä½¿ç”¨åœºæ™¯: å¦‚æœæ‚¨è¦å¯¹å•ä¾‹å¯¹è±¡è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œæ¯”å¦‚æ‰“å¼€çš„æ•°æ®åº“è¿æ¥æˆ–TensorFlowä¼šè¯ã€‚è¿™äº›å¯¹è±¡åªä¼šè¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œæ— è®ºæ‚¨çš„è„šæœ¬è¿è¡Œå¤šå°‘æ¬¡ã€‚

`lambda _: None` | [ç¤ºä¾‹](#example-2-turn-off-hashing-for-a-specific-type)

- é€Ÿåº¦: å¿«
- ä½¿ç”¨åœºæ™¯: å¦‚æœæ‚¨æƒ³è¦å…³é—­å¯¹æ­¤ç±»å‹çš„å“ˆå¸Œå¤„ç†ã€‚è¿™å¯¹äºæ‚¨çŸ¥é“å¯¹è±¡ä¸ä¼šæ”¹å˜æ—¶éå¸¸æœ‰ç”¨ã€‚

Pythonçš„[`hash()`](https://docs.python.org/3/library/functions.html#hash)å‡½æ•° | [ç¤ºä¾‹](#example-3-use-pythons-hash-function)

- é€Ÿåº¦ï¼šæ ¹æ®è¢«ç¼“å­˜å¯¹è±¡çš„å¤§å°å¯èƒ½ä¼šè¾ƒæ…¢
- ä½¿ç”¨åœºæ™¯ï¼šå¦‚æœPythonå·²ç»çŸ¥é“å¦‚ä½•æ­£ç¡®æ•£åˆ—æ­¤ç±»å‹ã€‚

è‡ªå®šä¹‰å“ˆå¸Œå‡½æ•° | [ç¤ºä¾‹](#the-hash_funcs-parameter)

- é€Ÿåº¦ï¼šä¸é€‚ç”¨
- ä½¿ç”¨åœºæ™¯ï¼šå¦‚æœæ‚¨æƒ³è¦è¦†ç›–Streamlitå¦‚ä½•æ•£åˆ—ç‰¹å®šç±»å‹ã€‚

### ç¤ºä¾‹1ï¼šä¼ é€’æ•°æ®åº“è¿æ¥

å‡è®¾æˆ‘ä»¬æƒ³è¦æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œå¯ä»¥åœ¨å¤šæ¬¡è¿è¡ŒStreamlitåº”ç”¨ç¨‹åºæ—¶é‡å¤ä½¿ç”¨ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨ç¼“å­˜å¯¹è±¡å­˜å‚¨çš„å¼•ç”¨æ¥è‡ªåŠ¨åˆå§‹åŒ–å’Œé‡ç”¨è¿æ¥ï¼š

```python
@st.cache(allow_output_mutation=True)
def get_database_connection():
    return db.get_connection()
```

åªéœ€è¦3è¡Œä»£ç ï¼Œæ•°æ®åº“è¿æ¥å°±ä¼šè¢«åˆ›å»ºä¸€æ¬¡å¹¶å­˜å‚¨åœ¨ç¼“å­˜ä¸­ã€‚ç„¶åï¼Œæ¯æ¬¡è°ƒç”¨`get_database_connection`æ—¶ï¼Œå·²åˆ›å»ºçš„è¿æ¥å¯¹è±¡ä¼šè‡ªåŠ¨é‡ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæˆä¸ºä¸€ä¸ªå•ä¾‹ã€‚

<æç¤º>

ä½¿ç”¨`allow_output_mutation=True`æ ‡å¿—æ¥æŠ‘åˆ¶ä¸å¯å˜æ€§æ£€æŸ¥ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢Streamlitå°è¯•å¯¹è¾“å‡ºè¿æ¥è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­å…³é—­Streamlitçš„å˜å¼‚è­¦å‘Šã€‚

</æç¤º>

å¦‚æœæ‚¨æƒ³ç¼–å†™ä¸€ä¸ªæ¥æ”¶æ•°æ®åº“è¿æ¥ä½œä¸ºè¾“å…¥çš„å‡½æ•°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`hash_funcs`ï¼š

```python
@st.cache(hash_funcs={DBConnection: id})
def get_users(connection):
    # Note: We assume that connection is of type DBConnection.
    return connection.execute_sql('SELECT * from Users')
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Pythonå†…ç½®çš„`id`å‡½æ•°ï¼Œå› ä¸ºè¿æ¥å¯¹è±¡æ˜¯é€šè¿‡`get_database_connection`å‡½æ•°ä»Streamlitç¼“å­˜ä¸­è·å–çš„ã€‚è¿™æ„å‘³ç€æ¯æ¬¡ä¼ é€’çš„éƒ½æ˜¯åŒä¸€ä¸ªè¿æ¥å®ä¾‹ï¼Œå› æ­¤å®ƒçš„idå§‹ç»ˆç›¸åŒã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ°å¥½æœ‰ä¸€ä¸ªæŒ‡å‘å®Œå…¨ä¸åŒæ•°æ®åº“çš„ç¬¬äºŒä¸ªè¿æ¥å¯¹è±¡ï¼Œä»ç„¶å¯ä»¥å®‰å…¨åœ°å°†å…¶ä¼ é€’ç»™`get_users`ï¼Œå› ä¸ºå®ƒçš„idä¿è¯ä¸ç¬¬ä¸€ä¸ªidä¸åŒã€‚

è¿™äº›è®¾è®¡æ¨¡å¼é€‚ç”¨äºä»»ä½•æ—¶å€™å½“æ‚¨æœ‰ä¸€ä¸ªæŒ‡å‘å¤–éƒ¨èµ„æºçš„å¯¹è±¡ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥æˆ–Tensorflowä¼šè¯ã€‚

### ç¤ºä¾‹2ï¼šä¸ºç‰¹å®šç±»å‹å…³é—­å“ˆå¸Œ

æ‚¨å¯ä»¥é€šè¿‡ä¸ºç‰¹å®šç±»å‹æä¾›ä¸€ä¸ªè‡ªå®šä¹‰å“ˆå¸Œå‡½æ•°æ¥å®Œå…¨å…³é—­å“ˆå¸Œã€‚æ‚¨å¯èƒ½è¿™æ ·åšçš„ä¸€ä¸ªåŸå› æ˜¯ä¸ºäº†é¿å…å¯¹å¤§å‹ã€æ…¢é€Ÿå“ˆå¸Œçš„å¯¹è±¡è¿›è¡Œå“ˆå¸Œï¼Œè€Œæ‚¨çŸ¥é“è¿™äº›å¯¹è±¡ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä¾‹å¦‚:

```python
@st.cache(hash_funcs={pd.DataFrame: lambda _: None})
def func(huge_constant_dataframe):
    ...
```

å½“Streamlité‡åˆ°è¿™ç§ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œæ— è®ºå®ƒæ­£åœ¨æŸ¥çœ‹å“ªä¸ª`FooType`çš„å®ä¾‹ï¼Œå®ƒæ€»æ˜¯å°†å¯¹è±¡è½¬æ¢ä¸º`None`ã€‚è¿™æ„å‘³ç€æ‰€æœ‰å®ä¾‹éƒ½è¢«å“ˆå¸Œä¸ºç›¸åŒçš„å€¼ï¼Œè¿™æœ‰æ•ˆåœ°å–æ¶ˆäº†å“ˆå¸Œæœºåˆ¶ã€‚

### ç¤ºä¾‹3ï¼šä½¿ç”¨Pythonçš„hash()å‡½æ•°

æœ‰æ—¶å€™ï¼Œæ‚¨å¯èƒ½æƒ³è¦ä½¿ç”¨Pythonçš„é»˜è®¤å“ˆå¸Œç®—æ³•ï¼Œè€Œä¸æ˜¯Streamlitçš„ã€‚ä¾‹å¦‚ï¼Œä¹Ÿè®¸æ‚¨é‡åˆ°äº†Streamlitæ— æ³•å“ˆå¸Œçš„ç±»å‹ï¼Œä½†æ˜¯ä½¿ç”¨Pythonå†…ç½®çš„`hash()`å‡½æ•°æ˜¯å¯å“ˆå¸Œçš„ï¼š

```python
@st.cache(hash_funcs={FooType: hash})
def func(...):
    ...
```